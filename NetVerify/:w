from func import Func
from queue import Queue
import threading
from db import DB
import time
import random


q = Queue(10)
threadlist = []
class SpiderOperator(threading.Thread):

    def __init__(self):
        super(SpiderOperator,self).__init__()
        self.operator = Func()

    def run(self):
        sid,idcard = q.get()
        self.operator.check(sid,idcard)
        q.task_done()

        
def main():
    db = DB()
    cur = db.get_info()
    for info in cur:
        queue.put(info)

    for i in range(8):
        consumer = SpiderOperator()
        threadlist.append(consumer)
        consumer.start()

    for i in threadlist:
        i.join()

    print('end')
